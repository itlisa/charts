exports.AgriPfscnew3dLib = function (t) { function e(n) { if (i[n]) return i[n].exports; var o = i[n] = { i: n, l: !1, exports: {} }; return t[n].call(o.exports, o, o.exports, e), o.l = !0, o.exports } var i = {}; return e.m = t, e.c = i, e.d = function (t, i, n) { e.o(t, i) || Object.defineProperty(t, i, { configurable: !1, enumerable: !0, get: n }) }, e.n = function (t) { var i = t && t.__esModule ? function () { return t.default } : function () { return t }; return e.d(i, "a", i), i }, e.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, e.p = "", e(e.s = 6) }([function (t, e) { t.exports = require("../lib/three.0.83/three.min") }, function (t, e) { function i() { if (arguments.length < 1) return null; for (var t = Object.create(arguments[0]), e = 1; e < arguments.length; e++)n(t, arguments[e]); return t } function n(t, e) { if (e && e !== Object.prototype) { Object.getOwnPropertyNames(e).forEach(function (i) { if ("constructor" == i) return !0; var n = Object.getOwnPropertyDescriptor(e, i); Object.defineProperty(t, i, n) }), n(t, Object.getPrototypeOf(e)) } } t.exports = i }, function (t, e) { function i(t) { if (t && !(t instanceof i)) throw new Error("Illegal target."); this._target = t } i.prototype = { constructor: i, _target: null, addEventListener: function (t, e, i) { var n = this; if (!t || "function" !== typeof e) throw new Error("Illegal parameters."); void 0 === n._mapKTypeVListenerTokens && (n._mapKTypeVListenerTokens = {}); var o = n._mapKTypeVListenerTokens[t]; void 0 === o && (o = [], n._mapKTypeVListenerTokens[t] = o); var r = { listener: e, thisArg: i }; o.push(r) }, removeEventListener: function (t, e) { var i = this; if (!t || "function" !== typeof e) throw new Error("Illegal parameters."); if (void 0 !== i._mapKTypeVListenerTokens) { var n = i._mapKTypeVListenerTokens[t]; if (void 0 !== n) { for (var o = -1, r = null, s = 0; s < n.length; s++)if (r = n[s], r.listener === e) { o = s; break } -1 !== o && (n.splice(o, 1), delete r.listener, delete r.thisArg), n.length < 1 && delete i._mapKTypeVListenerTokens[t] } } }, removeEventListeners: function (t) { var e = this; if (void 0 !== e._mapKTypeVListenerTokens) if (void 0 === t) for (var i in e._mapKTypeVListenerTokens) e._mapKTypeVListenerTokens.hasOwnProperty(i) && e.removeEventListeners(i); else { var n = e._mapKTypeVListenerTokens[t]; if (void 0 === n) return; for (var o = 0; o < n.length; o++) { var r = n[o]; delete r.listener, delete r.thisArg } delete e._mapKTypeVListenerTokens[t] } }, hasEventListener: function (t, e) { var i = this; if (!t) throw new Error("Illegal parameters."); if (void 0 === i._mapKTypeVListenerTokens) return !1; var n = i._mapKTypeVListenerTokens[t]; if (void 0 === e) return void 0 !== n; for (var o = 0; o < n.length; o++) { if (n[o].listener === e) return !0 } return !1 }, dispatchEvent: function (t) { var e = this; if (!t || !t.type) throw new Error("Illegal parameter event: " + t); if (t instanceof Event) { console.warn("It recommends to use Object instead of Event class."); var i = {}; for (var n in t) t[n] instanceof Function || (i[n] = t[n]); t = i } if (void 0 !== e._mapKTypeVListenerTokens) { var o = e._mapKTypeVListenerTokens[t.type]; if (void 0 !== o) { var r = this._target || e; t.target = r; for (var s = 0; s < o.length; s++) { var a = o[s]; a.listener.call(a.thisArg, t) } } } }, on: function (t, e, i) { this.addEventListener(t, e, i) }, off: function (t) { this.removeEventListeners(t) }, fire: function (t) { this.dispatchEvent(t) } }, t.exports = i }, function (t, e, i) { (function (i) { var n, o, r = r || function () { var t = []; return { getAll: function () { return t }, removeAll: function () { t = [] }, add: function (e) { t.push(e) }, remove: function (e) { -1 !== (e = t.indexOf(e)) && t.splice(e, 1) }, update: function (e, i) { if (0 === t.length) return !1; var n = 0; for (e = void 0 !== e ? e : r.now(); n < t.length;)t[n].update(e) || i ? n++ : t.splice(n, 1); return !0 } } }(); (function () { r.now = void 0 === this.window && void 0 !== this.process ? function () { var t = i.hrtime(); return 1e3 * t[0] + t[1] / 1e6 } : void 0 !== this.window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now.bind(window.performance) : void 0 !== Date.now ? Date.now : function () { return (new Date()).getTime() } }).call(this), r.Tween = function (t) { var e, i, n = {}, o = {}, s = {}, a = 1e3, c = 0, h = !1, u = !1, l = 0, d = null, p = r.Easing.Linear.None, f = r.Interpolation.Linear, _ = [], m = null, v = !1, g = null, b = null, O = null; for (i in t) n[i] = parseFloat(t[i], 10); this.to = function (t, e) { return void 0 !== e && (a = e), o = t, this }, this.start = function (e) { r.add(this), u = !0, v = !1, d = void 0 !== e ? e : r.now(), d += l; for (var i in o) { if (o[i] instanceof Array) { if (0 === o[i].length) continue; o[i] = [t[i]].concat(o[i]) } void 0 !== t[i] && (n[i] = t[i], !1 == n[i] instanceof Array && (n[i] *= 1), s[i] = n[i] || 0) } return this }, this.stop = function () { return u ? (r.remove(this), u = !1, null !== O && O.call(t, t), this.stopChainedTweens(), this) : this }, this.end = function () { return this.update(d + a), this }, this.stopChainedTweens = function () { for (var t = 0, e = _.length; t < e; t++)_[t].stop() }, this.delay = function (t) { return l = t, this }, this.repeat = function (t) { return c = t, this }, this.repeatDelay = function (t) { return e = t, this }, this.yoyo = function (t) { return h = t, this }, this.easing = function (t) { return p = t, this }, this.interpolation = function (t) { return f = t, this }, this.chain = function () { return _ = arguments, this }, this.onStart = function (t) { return m = t, this }, this.onUpdate = function (t) { return g = t, this }, this.onComplete = function (t) { return b = t, this }, this.onStop = function (t) { return O = t, this }, this.update = function (i) { var r, u, O; if (i < d) return !0; !1 === v && (null !== m && m.call(t, t), v = !0), u = (i - d) / a, u = 1 < u ? 1 : u, O = p(u); for (r in o) if (void 0 !== n[r]) { var y = n[r] || 0, j = o[r]; j instanceof Array ? t[r] = f(j, O) : ("string" === typeof j && (j = "+" === j.charAt(0) || "-" === j.charAt(0) ? y + parseFloat(j, 10) : parseFloat(j, 10)), "number" === typeof j && (t[r] = y + (j - y) * O)) } if (null !== g && g.call(t, O), 1 === u) { if (!(0 < c)) { for (null !== b && b.call(t, t), i = 0, r = _.length; i < r; i++)_[i].start(d + a); return !1 } isFinite(c) && c--; for (r in s) "string" === typeof o[r] && (s[r] += parseFloat(o[r], 10)), h && (u = s[r], s[r] = o[r], o[r] = u), n[r] = s[r]; d = void 0 !== e ? i + e : i + l } return !0 } }, r.Easing = { Linear: { None: function (t) { return t } }, Quadratic: { In: function (t) { return t * t }, Out: function (t) { return t * (2 - t) }, InOut: function (t) { return 1 > (t *= 2) ? .5 * t * t : -.5 * (--t * (t - 2) - 1) } }, Cubic: { In: function (t) { return t * t * t }, Out: function (t) { return --t * t * t + 1 }, InOut: function (t) { return 1 > (t *= 2) ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2) } }, Quartic: { In: function (t) { return t * t * t * t }, Out: function (t) { return 1 - --t * t * t * t }, InOut: function (t) { return 1 > (t *= 2) ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2) } }, Quintic: { In: function (t) { return t * t * t * t * t }, Out: function (t) { return --t * t * t * t * t + 1 }, InOut: function (t) { return 1 > (t *= 2) ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2) } }, Sinusoidal: { In: function (t) { return 1 - Math.cos(t * Math.PI / 2) }, Out: function (t) { return Math.sin(t * Math.PI / 2) }, InOut: function (t) { return .5 * (1 - Math.cos(Math.PI * t)) } }, Exponential: { In: function (t) { return 0 === t ? 0 : Math.pow(1024, t - 1) }, Out: function (t) { return 1 === t ? 1 : 1 - Math.pow(2, -10 * t) }, InOut: function (t) { return 0 === t ? 0 : 1 === t ? 1 : 1 > (t *= 2) ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1))) } }, Circular: { In: function (t) { return 1 - Math.sqrt(1 - t * t) }, Out: function (t) { return Math.sqrt(1 - --t * t) }, InOut: function (t) { return 1 > (t *= 2) ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1) } }, Elastic: { In: function (t) { return 0 === t ? 0 : 1 === t ? 1 : -Math.pow(2, 10 * (t - 1)) * Math.sin(5 * (t - 1.1) * Math.PI) }, Out: function (t) { return 0 === t ? 0 : 1 === t ? 1 : Math.pow(2, -10 * t) * Math.sin(5 * (t - .1) * Math.PI) + 1 }, InOut: function (t) { return 0 === t ? 0 : 1 === t ? 1 : (t *= 2, 1 > t ? -.5 * Math.pow(2, 10 * (t - 1)) * Math.sin(5 * (t - 1.1) * Math.PI) : .5 * Math.pow(2, -10 * (t - 1)) * Math.sin(5 * (t - 1.1) * Math.PI) + 1) } }, Back: { In: function (t) { return t * t * (2.70158 * t - 1.70158) }, Out: function (t) { return --t * t * (2.70158 * t + 1.70158) + 1 }, InOut: function (t) { return 1 > (t *= 2) ? .5 * t * t * (3.5949095 * t - 2.5949095) : .5 * ((t -= 2) * t * (3.5949095 * t + 2.5949095) + 2) } }, Bounce: { In: function (t) { return 1 - r.Easing.Bounce.Out(1 - t) }, Out: function (t) { return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375 }, InOut: function (t) { return .5 > t ? .5 * r.Easing.Bounce.In(2 * t) : .5 * r.Easing.Bounce.Out(2 * t - 1) + .5 } } }, r.Interpolation = { Linear: function (t, e) { var i = t.length - 1, n = i * e, o = Math.floor(n), s = r.Interpolation.Utils.Linear; return 0 > e ? s(t[0], t[1], n) : 1 < e ? s(t[i], t[i - 1], i - n) : s(t[o], t[o + 1 > i ? i : o + 1], n - o) }, Bezier: function (t, e) { for (var i = 0, n = t.length - 1, o = Math.pow, s = r.Interpolation.Utils.Bernstein, a = 0; a <= n; a++)i += o(1 - e, n - a) * o(e, a) * t[a] * s(n, a); return i }, CatmullRom: function (t, e) { var i = t.length - 1, n = i * e, o = Math.floor(n), s = r.Interpolation.Utils.CatmullRom; return t[0] === t[i] ? (0 > e && (o = Math.floor(n = i * (1 + e))), s(t[(o - 1 + i) % i], t[o], t[(o + 1) % i], t[(o + 2) % i], n - o)) : 0 > e ? t[0] - (s(t[0], t[0], t[1], t[1], -n) - t[0]) : 1 < e ? t[i] - (s(t[i], t[i], t[i - 1], t[i - 1], n - i) - t[i]) : s(t[o ? o - 1 : 0], t[o], t[i < o + 1 ? i : o + 1], t[i < o + 2 ? i : o + 2], n - o) }, Utils: { Linear: function (t, e, i) { return (e - t) * i + t }, Bernstein: function (t, e) { var i = r.Interpolation.Utils.Factorial; return i(t) / i(e) / i(t - e) }, Factorial: function () { var t = [1]; return function (e) { var i = 1; if (t[e]) return t[e]; for (var n = e; 1 < n; n--)i *= n; return t[e] = i } }(), CatmullRom: function (t, e, i, n, o) { t = .5 * (i - t), n = .5 * (n - e); var r = o * o; return (2 * e - 2 * i + t + n) * o * r + (-3 * e + 3 * i - 2 * t - n) * r + t * o + e } } }, function (i) { n = [], void 0 !== (o = function () { return r }.apply(e, n)) && (t.exports = o) }() }).call(e, i(9)) }, function (t, e, i) { function n() { r.call(this) } var o = i(1), r = i(2), s = i(11); n.prototype = o(r.prototype, { constructor: n, _invalidatePropertiesFlag: !1, _invalidateSizeFlag: !1, _invalidateDisplayListFlag: !1, _x: 0, get x() { return this._x }, set x(t) { this._x != t && (this._x = t, this.invalidateProperties(), this.invalidateSize(), this.invalidateDisplayList()) }, _y: 0, get y() { return this._y }, set y(t) { this._y != t && (this._y = t, this.invalidateProperties(), this.invalidateSize(), this.invalidateDisplayList()) }, _width: 100, get width() { return this._width }, set width(t) { this._width != t && (this._width = t, this.invalidateProperties(), this.invalidateSize(), this.invalidateDisplayList()) }, _height: 100, get height() { return this._height }, set height(t) { this._height != t && (this._height = t, this.invalidateProperties(), this.invalidateSize(), this.invalidateDisplayList()) }, initialize: function () { }, invalidateProperties: function () { this._invalidatePropertiesFlag || (this._invalidatePropertiesFlag = !0, s.getInstance().invalidateProperties(this)) }, invalidateSize: function () { this._invalidateSizeFlag || (this._invalidateSizeFlag = !0, s.getInstance().invalidateSize(this)) }, invalidateDisplayList: function () { this._invalidateDisplayListFlag || (this._invalidateDisplayListFlag = !0, s.getInstance().invalidateDisplayList(this)) }, validateNow: function () { s.getInstance().validateClient(this) }, validateProperties: function () { this._invalidatePropertiesFlag && (this.commitProperties(), this._invalidatePropertiesFlag = !1) }, validateSize: function () { this._invalidateSizeFlag && (this.measure(), this._invalidateSizeFlag = !1) }, validateDisplayList: function () { this._invalidateDisplayListFlag && (this.updateDisplayList(), this._invalidateDisplayListFlag = !1) }, commitProperties: function () { }, measure: function () { }, updateDisplayList: function () { }, setStyle: function () { } }), t.exports = n }, function (t, e, i) { function n(t, e) { r.call(this), this._run = this._run.bind(this), this._setIntervalHandler = this._setIntervalHandler.bind(this), this._requestAnimationFrameHandler = this._requestAnimationFrameHandler.bind(this), this.delay(t), this.repeatCount(e || 0) } var o = i(1), r = i(2); n.REQUEST_ANIMATION_FRAME = -4132, n.prototype = o(r.prototype, { constructor: n, _delay: void 0, _repeatCount: 0, _currentCount: 0, _intervalId: void 0, _setIntervalHandler: function () { this._run() }, _requestAnimationFrameFlag: !1, _requestAnimationFrameCount: 0, _requestAnimationFrameHandler: function () { 1 == this._requestAnimationFrameCount && this._run(), this._requestAnimationFrameCount < 1 && this._requestAnimationFrameCount++ , this._requestAnimationFrameFlag && requestAnimationFrame(this._requestAnimationFrameHandler) }, _run: function () { if (0 != this._repeatCount && this._currentCount >= this._repeatCount) return this.stop(), void this.fire({ type: "timerComplete" }); this._currentCount++ , this.fire({ type: "timer" }) }, delay: function (t) { if (0 == arguments.length) return this._delay; if (this._delay != t) { if (isNaN(t) || !isFinite(t) || t <= 0 && t != n.REQUEST_ANIMATION_FRAME) throw new Error("Illegal delay value: " + t); return this._delay = t, this.running() && (this.stop(), this.start()), this } }, repeatCount: function (t) { if (0 == arguments.length) return this._repeatCount; if (this._repeatCount != t) { if (isNaN(t) || !isFinite(t) || t < 0) throw new Error("Illegal repeat count value: " + t); return this._repeatCount = t, this } }, currentCount: function () { return this._currentCount }, running: function () { return "number" === typeof this._intervalId || this._requestAnimationFrameFlag }, reset: function () { this.stop(), this._currentCount = 0 }, start: function () { this.running() || (this._delay == n.REQUEST_ANIMATION_FRAME && "function" === typeof requestAnimationFrame ? (this._requestAnimationFrameFlag = !0, requestAnimationFrame(this._requestAnimationFrameHandler)) : this._delay > 0 && (this._intervalId = setInterval(this._setIntervalHandler, this._delay))) }, stop: function () { this.running() && (clearInterval(this._intervalId), this._intervalId = null, this._requestAnimationFrameFlag = !1, this._requestAnimationFrameCount = 0) } }), t.exports = n }, function (t, e, i) { i(7), e.AdjacencyMatrix = i(8), e.webgl = i(22).webgl }, function (t, e) { void 0 === window.console && (window.console = { info: function () { }, warn: function () { }, error: function () { }, log: function () { } }), "function" !== typeof Object.assign && (Object.assign = function (t) { if (void 0 === t || null === t) throw new TypeError("Cannot convert undefined or null to object"); for (var e = Object(t), i = 1; i < arguments.length; i++) { var n = arguments[i]; if (void 0 !== n && null !== n) for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]) } return e }) }, function (t, e, i) { var n = i(0), o = i(3), r = i(1), s = i(2), a = i(10), c = i(5); i(15); var h = function (t) { this._parameters = t || {}, this._initEnv(), this._initMatrix(), this._tweenObject = { t: 0 }, this._initialized = !0 }; h.prototype = r(s.prototype, { constructor: h, _parameters: void 0, _initialized: !1, _stats: void 0, _stage3d: void 0, _timer: void 0, _controls: void 0, _tween: void 0, _adjacencyMatrix: null, _grid: null, _border: null, _addLight: function (t, e, i, o, r) { var s = new n.PointLight(t, e); s.position.set(i, o, r), this._stage3d.scene.add(s) }, _initEnv: function () { if (!this._initialized) { var t = this, e = t._parameters, i = e.cameraPosition || [-267.93437850756305, 285.3199110544426, 311.1329573826135]; this._stage3d = new a(), this._stage3d.interactiveManager.useOctree = !1, this._stage3d.camera.position.set(i[0], i[1], i[2]), this._timer = new c(c.REQUEST_ANIMATION_FRAME), this._timer.on("timer", function () { o.update(), t._stage3d.render() }), this._timer.start(), this._controls = new n.OrbitControls(t._stage3d.camera, t._stage3d.domElement), this._controls.enableDamping = !0, this._controls.dampingFactor = .25, this._controls.rotateSpeed = .35, t._stage3d.domElement.addEventListener("dblclick", function (e) { var i = t._stage3d.camera.position; e.shiftKey && console.log([i.x, i.y, i.z].join(",")) }); var r = 400; this._addLight(16777215, 1, r, r, r), this._addLight(16777215, 1, -r, r, -r) } }, _initMatrix: function () { if (!this._initialized) { var t = this, e = function (e) { t.dispatchEvent(e) }; this._adjacencyMatrix = new (i(16))(), this._adjacencyMatrix.palette = this._parameters.palette, this._adjacencyMatrix.on("itemMouseOver", e), this._adjacencyMatrix.on("itemMouseOut", e), this._adjacencyMatrix.on("itemClick", e), this._adjacencyMatrix.position.y = 100, this._stage3d.addObject(this._adjacencyMatrix); var o = this._parameters.data; o && (this._adjacencyMatrix.vertexData = o.vertices, this._adjacencyMatrix.edgeData = o.edges), this._parameters.grid && (this._grid = new n.Mesh(new n.PlaneBufferGeometry(this._adjacencyMatrix.measuredWidth, this._adjacencyMatrix.measuredHeight), new n.MeshBasicMaterial({ map: (new n.TextureLoader()).load(this._parameters.grid), transparent: !0, depthWrite: !1, side: n.DoubleSide })), this._grid.position.y = this._adjacencyMatrix.position.y - 2, this._grid.rotation.x = Math.PI / 2, this._grid.size = 1.5, this._grid.scale.set(.01, .01, .01), this._stage3d.addObject(this._grid)), this._parameters.border && (this._border = new n.Mesh(new n.PlaneBufferGeometry(this._adjacencyMatrix.measuredWidth, this._adjacencyMatrix.measuredHeight), new n.MeshBasicMaterial({ map: (new n.TextureLoader()).load(this._parameters.border), transparent: !0, depthWrite: !1, side: n.DoubleSide })), this._border.position.y = this._adjacencyMatrix.position.y - 1, this._border.rotation.x = Math.PI / 2, this._border.size = 1.3, this._border.scale.set(.01, .01, .01), this._stage3d.addObject(this._border)) } }, get domElement() { return this._stage3d.domElement }, _data: void 0, get data() { return this._data }, set data(t) { if (this._data = t, this._data) { var e = this; this.disappear(function () { e._adjacencyMatrix.vertexData = e.data.vertices, e._adjacencyMatrix.edgeData = e.data.edges, e._adjacencyMatrix.validateNow(), e.appear() }) } }, start: function () { this._timer.start() }, stop: function () { this._timer.stop() }, _tween: void 0, _tweenObject: void 0, appear: function (t) { this._adjacencyMatrix.appear(void 0, void 0, t), this._tween && (this._tween.stop(), this._tween = null); var e = this; this._tween = new o.Tween(this._tweenObject).to({ t: 1 }, 1e3).easing(o.Easing.Cubic.InOut).delay(0).onUpdate(function () { if (e._grid) { var t = Math.max(.01, this.t * e._grid.size); e._grid.scale.set(t, t, t) } e._border && (t = Math.max(.01, this.t * e._border.size), e._border.scale.set(t, t, t)) }).onComplete(function () { }).start() }, disappear: function (t) { this._adjacencyMatrix.disappear(void 0, void 0, t), this._tween && (this._tween.stop(), this._tween = null); var e = this; this._tween = new o.Tween(this._tweenObject).to({ t: 0 }, 1e3).easing(o.Easing.Cubic.InOut).delay(0).onUpdate(function () { if (e._grid) { var t = Math.max(.01, this.t * e._grid.size); e._grid.scale.set(t, t, t) } e._border && (t = Math.max(.01, this.t * e._border.size), e._border.scale.set(t, t, t)) }).onComplete(function () { }).start() }, flip: function (t) { this._adjacencyMatrix.flip(t) }, resize: function (t, e) { this._stage3d.width = t, this._stage3d.height = e } }), t.exports = h }, function (t, e) { function i() { throw new Error("setTimeout has not been defined") } function n() { throw new Error("clearTimeout has not been defined") } function o(t) { if (u === setTimeout) return setTimeout(t, 0); if ((u === i || !u) && setTimeout) return u = setTimeout, setTimeout(t, 0); try { return u(t, 0) } catch (e) { try { return u.call(null, t, 0) } catch (e) { return u.call(this, t, 0) } } } function r(t) { if (l === clearTimeout) return clearTimeout(t); if ((l === n || !l) && clearTimeout) return l = clearTimeout, clearTimeout(t); try { return l(t) } catch (e) { try { return l.call(null, t) } catch (e) { return l.call(this, t) } } } function s() { _ && p && (_ = !1, p.length ? f = p.concat(f) : m = -1, f.length && a()) } function a() { if (!_) { var t = o(s); _ = !0; for (var e = f.length; e;) { for (p = f, f = []; ++m < e;)p && p[m].run(); m = -1, e = f.length } p = null, _ = !1, r(t) } } function c(t, e) { this.fun = t, this.array = e } function h() { } var u, l, d = t.exports = {}; !function () { try { u = "function" === typeof setTimeout ? setTimeout : i } catch (t) { u = i } try { l = "function" === typeof clearTimeout ? clearTimeout : n } catch (t) { l = n } }(); var p, f = [], _ = !1, m = -1; d.nextTick = function (t) { var e = new Array(arguments.length - 1); if (arguments.length > 1) for (var i = 1; i < arguments.length; i++)e[i - 1] = arguments[i]; f.push(new c(t, e)), 1 !== f.length || _ || o(a) }, c.prototype.run = function () { this.fun.apply(null, this.array) }, d.title = "browser", d.browser = !0, d.env = {}, d.argv = [], d.version = "", d.versions = {}, d.on = h, d.addListener = h, d.once = h, d.off = h, d.removeListener = h, d.removeAllListeners = h, d.emit = h, d.prependListener = h, d.prependOnceListener = h, d.listeners = function (t) { return [] }, d.binding = function (t) { throw new Error("process.binding is not supported") }, d.cwd = function () { return "/" }, d.chdir = function (t) { throw new Error("process.chdir is not supported") }, d.umask = function () { return 0 } }, function (t, e, i) { function n() { this._scene = new r.Scene(), this._camera = new r.PerspectiveCamera(75, this._width / this._height, 1, 1e4), this._renderer = new r.WebGLRenderer({ antialias: !0, alpha: !0 }), "number" === typeof window.devicePixelRatio && this._renderer.setPixelRatio(window.devicePixelRatio), this._renderer.setClearColor(0, 0), this._renderer.setSize(this._width, this._height), this._interactiveManager = new a(), this._interactiveManager.stage3d = this, this._renderableManager = new c() } var o = i(1), r = i(0), s = i(4), a = i(12), c = i(14); n.prototype = o(s.prototype, { constructor: n, _captureExecutor: null, _scene: null, get scene() { return this._scene }, set scene(t) { this._scene = t }, _camera: null, get camera() { return this._camera }, set camera(t) { this._camera = t }, _renderer: null, get renderer() { return this._renderer }, set renderer(t) { this._renderer = t }, _interactiveManager: null, get interactiveManager() { return this._interactiveManager }, set interactiveManager(t) { this._interactiveManager = t }, _renderableManager: null, get renderableManager() { return this._renderableManager }, set renderableManager(t) { this._renderableManager = t }, get domElement() { return this._renderer ? this._renderer.domElement : null }, get stageX() { return this._interactiveManager ? this._interactiveManager.stageX : 0 }, get stageY() { return this._interactiveManager ? this._interactiveManager.stageY : 0 }, updateDisplayList: function () { this._camera instanceof r.PerspectiveCamera ? this._camera.aspect = this._width / this._height : this._camera instanceof r.OrthographicCamera && (this._camera.left = this._width / -2, this._camera.right = this._width / 2, this._camera.top = this._height / 2, this._camera.bottom = this._height / -2), this._camera.updateProjectionMatrix(), this._renderer.setSize(this._width, this._height) }, capture: function (t, e) { if ("function" === typeof t) { var i = this; this._captureExecutor = function () { t(i.domElement.toDataURL(e || "image/png")), i._captureExecutor = null } } }, render: function () { this._renderableManager.update(), this._renderer.render(this._scene, this._camera), "function" === typeof this._captureExecutor && this._captureExecutor(), this._interactiveManager.update() }, addObject: function (t) { t._stage3d = this, "function" === typeof t._addedToStage && t._addedToStage(), this.scene.add(t) }, removeObject: function (t) { this.scene.remove(t), "function" === typeof t._removedFromStage && t._removedFromStage(), t._stage3d = null } }), t.exports = n }, function (t, e, i) { function n() { Object.call(this), this._timerCompleteHandler = this._timerCompleteHandler.bind(this), this._timer = new o(o.REQUEST_ANIMATION_FRAME, 1), this._timer.on("timerComplete", this._timerCompleteHandler, this) } var o = i(5); n.prototype = { constructor: n, _initialized: !1, _timer: null, _invalidatePropertiesQueue: [], _invalidatePropertiesFlag: !1, _invalidateSizeQueue: [], _invalidateSizeFlag: !1, _invalidateDisplayListQueue: [], _invalidateDisplayListFlag: !1, _timerCompleteHandler: function (t) { this._invalidatePropertiesFlag && this._validateProperties(), this._invalidateSizeFlag && this._validateSize(), this._invalidateDisplayListFlag && this._validateDisplayList() }, invalidateProperties: function (t) { t && "function" === typeof t.validateProperties && (this._invalidatePropertiesQueue.push(t), this._invalidatePropertiesFlag = !0, this._timer.running() || this._timer.start()) }, invalidateSize: function (t) { t && "function" === typeof t.validateSize && (this._invalidateSizeQueue.push(t), this._invalidateSizeFlag = !0, this._timer.running() || this._timer.start()) }, invalidateDisplayList: function (t) { t && "function" === typeof t.validateDisplayList && (this._invalidateDisplayListQueue.push(t), this._invalidateDisplayListFlag = !0, this._timer.running() || this._timer.start()) }, validateClient: function (t) { if (!t) throw new Error("Target is NULL."); "function" === typeof t.validateProperties && t.validateProperties(), "function" === typeof t.validateSize && t.validateSize(), "function" === typeof t.validateDisplayList && t.validateDisplayList() }, _validateProperties: function () { for (; this._invalidatePropertiesQueue.length > 0;) { this._invalidatePropertiesQueue.pop().validateProperties() } this._invalidatePropertiesFlag = !1 }, _validateSize: function () { for (; this._invalidateSizeQueue.length > 0;) { this._invalidateSizeQueue.pop().validateSize() } this._invalidateSizeFlag = !1 }, _validateDisplayList: function () { for (; this._invalidateDisplayListQueue.length > 0;) { this._invalidateDisplayListQueue.pop().validateDisplayList() } this._invalidateDisplayListFlag = !1 } }; var r = new n(); n.getInstance = function () { return r }, t.exports = n }, function (t, e, i) { function n() { this._objects = {}, this._objectList = [], this._numObjects = 0, this._octree = new o.Octree({ undeferred: !1, depthMax: 1 / 0, objectsThreshold: 8, overlapPct: .15 }), this._mouse = {}, this._raycaster = new o.Raycaster(), this._domElementMouseMoveHandler = this._domElementMouseMoveHandler.bind(this), this._domElementClickHandler = this._domElementClickHandler.bind(this), this._domElementDoubleClickHandler = this._domElementDoubleClickHandler.bind(this) } var o = i(0); i(13), n.prototype = { constructor: n, _objects: null, _objectList: null, _numObjects: 0, _octree: null, _mouse: null, _object: null, _faceIndex: null, _index: null, _raycaster: null, get raycaster() { return this._raycaster }, set raycaster(t) { this._raycaster = t }, _stage3d: null, get stage3d() { return this._stage3d }, set stage3d(t) { this._stage3d != t && (this._stage3d && (this._stage3d.domElement.removeEventListener("mousemove", this._domElementMouseMoveHandler), this._stage3d.domElement.removeEventListener("click", this._domElementClickHandler), this._stage3d.domElement.removeEventListener("dblclick", this._domElementDoubleClickHandler), this._stage3d = null), this._stage3d = t, this._stage3d && (this._stage3d.domElement.addEventListener("mousemove", this._domElementMouseMoveHandler), this._stage3d.domElement.addEventListener("click", this._domElementClickHandler), this._stage3d.domElement.addEventListener("dblclick", this._domElementDoubleClickHandler))) }, _useOctree: !1, get useOctree() { return this._useOctree }, set useOctree(t) { this._useOctree = t }, get stageX() { return this._mouse.stageX }, get stageY() { return this._mouse.stageY }, _getObjectId: function (t) { return t.id + ":" + t.uuid }, _domElementMouseMoveHandler: function (t) { t.preventDefault(), this._mouse.x = t.offsetX / this._stage3d.width * 2 - 1, this._mouse.y = -t.offsetY / this._stage3d.height * 2 + 1, this._mouse.stageX = t.pageX, this._mouse.stageY = t.pageY, this._mouse.event = t, this.pick(t) }, _domElementClickHandler: function (t) { this.pick(t) }, _domElementDoubleClickHandler: function (t) { this.pick(t) }, add: function (t, e) { var i = this._getObjectId(t); this.contains(i) || (this._objects[i] = t, this._useOctree ? this._octree.add(t, { useFaces: e }) : this._objectList.push(t), this._numObjects++) }, remove: function (t) { var e = this._getObjectId(t); if (this.contains(e)) { delete this._objects[e]; var i = this._objectList.indexOf(t); -1 != i && this._objectList.splice(i, 1), this._octree.remove(t), this._numObjects-- } }, contains: function (t) { return t instanceof o.Object3D && (t = this._getObjectId(t)), void 0 !== this._objects[t] }, update: function () { this._useOctree && this._octree.update() }, pick: function (t) { if (!this._raycaster || !this._stage3d || this._numObjects < 1) return null; if (this._raycaster.setFromCamera(this._mouse, this._stage3d.camera), this._useOctree) var e = this._octree.search(this._raycaster.ray.origin, this._raycaster.ray.far, !0, this._raycaster.ray.direction), i = this._raycaster.intersectOctreeObjects(e); else var i = this._raycaster.intersectObjects(this._objectList); if (i.length > 0) { this._useOctree && i.sort(function (t, e) { return t.distance > e.distance ? 1 : -1 }); var n = i[0]; t && (t.face = n.face, t.index = n.index, t.faceIndex = n.faceIndex), this._object != n.object ? (this._object && "function" === typeof this._object.mouseOut && this._object.mouseOut(t), this._object = n.object, "function" === typeof this._object.mouseOver && this._object.mouseOver(t)) : this._object.useFaces && this._index != n.index && (this._index = n.index, "function" === typeof this._object.mouseOver && this._object.mouseOver(t)), t && ("click" == t.type && "function" === typeof this._object.click ? this._object.click(t) : "dblclick" == t.type && "function" === typeof this._object.doubleClick && this._object.doubleClick(t)), this._stage3d.domElement.style.cursor = "pointer" } else this._object && "function" === typeof this._object.mouseOut && this._object.mouseOut(t), this._object = null, this._faceIndex = null, this._stage3d.domElement.style.cursor = "default"; return i } }, t.exports = n }, function (t, e, i) {/*!
 *
 * threeoctree.js (r60) / https://github.com/collinhover/threeoctree
 * (sparse) dynamic 3D spatial representation structure for fast searches.
 *
 * @author Collin Hover / http://collinhover.com/
 * based on Dynamic Octree by Piko3D @ http://www.piko3d.com/ and Octree by Marek Pawlowski @ pawlowski.it
 *
 */
  var n = i(0); !function (t) { function e(t) { return !isNaN(t) && isFinite(t) } function i(t) { return "[object Array]" === Object.prototype.toString.call(t) } function n(t) { return t ? !0 !== i(t) ? [t] : t : [] } function o(t, e) { for (var i = 0, n = t.length; i < n; i++)if (t[i] === e) return i; return -1 } function r(t, e, i) { for (var n = 0, o = t.length; n < o; n++)if (t[n][e] === i) return n; return -1 } t.Octree = function (i) { i = i || {}, i.tree = this, this.nodeCount = 0, this.INDEX_INSIDE_CROSS = -1, this.INDEX_OUTSIDE_OFFSET = 2, this.INDEX_OUTSIDE_POS_X = e(i.INDEX_OUTSIDE_POS_X) ? i.INDEX_OUTSIDE_POS_X : 0, this.INDEX_OUTSIDE_NEG_X = e(i.INDEX_OUTSIDE_NEG_X) ? i.INDEX_OUTSIDE_NEG_X : 1, this.INDEX_OUTSIDE_POS_Y = e(i.INDEX_OUTSIDE_POS_Y) ? i.INDEX_OUTSIDE_POS_Y : 2, this.INDEX_OUTSIDE_NEG_Y = e(i.INDEX_OUTSIDE_NEG_Y) ? i.INDEX_OUTSIDE_NEG_Y : 3, this.INDEX_OUTSIDE_POS_Z = e(i.INDEX_OUTSIDE_POS_Z) ? i.INDEX_OUTSIDE_POS_Z : 4, this.INDEX_OUTSIDE_NEG_Z = e(i.INDEX_OUTSIDE_NEG_Z) ? i.INDEX_OUTSIDE_NEG_Z : 5, this.INDEX_OUTSIDE_MAP = [], this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X] = { index: this.INDEX_OUTSIDE_POS_X, count: 0, x: 1, y: 0, z: 0 }, this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X] = { index: this.INDEX_OUTSIDE_NEG_X, count: 0, x: -1, y: 0, z: 0 }, this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y] = { index: this.INDEX_OUTSIDE_POS_Y, count: 0, x: 0, y: 1, z: 0 }, this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y] = { index: this.INDEX_OUTSIDE_NEG_Y, count: 0, x: 0, y: -1, z: 0 }, this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z] = { index: this.INDEX_OUTSIDE_POS_Z, count: 0, x: 0, y: 0, z: 1 }, this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z] = { index: this.INDEX_OUTSIDE_NEG_Z, count: 0, x: 0, y: 0, z: -1 }, this.FLAG_POS_X = 1 << this.INDEX_OUTSIDE_POS_X + 1, this.FLAG_NEG_X = 1 << this.INDEX_OUTSIDE_NEG_X + 1, this.FLAG_POS_Y = 1 << this.INDEX_OUTSIDE_POS_Y + 1, this.FLAG_NEG_Y = 1 << this.INDEX_OUTSIDE_NEG_Y + 1, this.FLAG_POS_Z = 1 << this.INDEX_OUTSIDE_POS_Z + 1, this.FLAG_NEG_Z = 1 << this.INDEX_OUTSIDE_NEG_Z + 1, this.utilVec31Search = new t.Vector3(), this.utilVec32Search = new t.Vector3(), this.scene = i.scene, this.scene && (this.visualGeometry = new t.BoxGeometry(1, 1, 1), this.visualMaterial = new t.MeshBasicMaterial({ color: 16711782, wireframe: !0, wireframeLinewidth: 1 })), this.objects = [], this.objectsMap = {}, this.objectsData = [], this.objectsDeferred = [], this.depthMax = e(i.depthMax) ? i.depthMax : 1 / 0, this.objectsThreshold = e(i.objectsThreshold) ? i.objectsThreshold : 8, this.overlapPct = e(i.overlapPct) ? i.overlapPct : .15, this.undeferred = i.undeferred || !1, this.root = i.root instanceof t.OctreeNode ? i.root : new t.OctreeNode(i) }, t.Octree.prototype = { update: function () { if (this.objectsDeferred.length > 0) { for (var t = 0, e = this.objectsDeferred.length; t < e; t++) { var i = this.objectsDeferred[t]; this.addDeferred(i.object, i.options) } this.objectsDeferred.length = 0 } }, add: function (t, e) { this.undeferred ? (this.updateObject(t), this.addDeferred(t, e)) : this.objectsDeferred.push({ object: t, options: e }) }, addDeferred: function (e, i) { var n, o, r, s, a, c, h; if (e instanceof t.OctreeObjectData && (e = e.object), e.uuid || (e.uuid = t.Math.generateUUID()), !this.objectsMap[e.uuid]) if (this.objects.push(e), this.objectsMap[e.uuid] = e, i && (a = i.useFaces, h = i.useVertices), !0 === h) for (r = e.geometry, c = r.vertices, n = 0, o = c.length; n < o; n++)this.addObjectData(e, c[n]); else if (!0 === a) for (r = e.geometry, s = r.faces, n = 0, o = s.length; n < o; n++)this.addObjectData(e, s[n]); else this.addObjectData(e) }, addObjectData: function (e, i) { var n = new t.OctreeObjectData(e, i); this.objectsData.push(n), this.root.addObject(n) }, remove: function (e) { var i, n, s, a, c = e; if (e instanceof t.OctreeObjectData && (e = e.object), this.objectsMap[e.uuid]) { if (this.objectsMap[e.uuid] = void 0, -1 !== (s = o(this.objects, e))) for (this.objects.splice(s, 1), a = this.root.removeObject(c), i = 0, n = a.length; i < n; i++)c = a[i], -1 !== (s = o(this.objectsData, c)) && this.objectsData.splice(s, 1) } else this.objectsDeferred.length > 0 && -1 !== (s = r(this.objectsDeferred, "object", e)) && this.objectsDeferred.splice(s, 1) }, extend: function (e) { var i, n, o, r; if (e instanceof t.Octree) for (o = e.objectsData, i = 0, n = o.length; i < n; i++)r = o[i], this.add(r, { useFaces: r.faces, useVertices: r.vertices }) }, rebuild: function () { var e, i, n, o, r, s = []; for (e = 0, i = this.objectsData.length; e < i; e++)o = this.objectsData[e], n = o.node, o.update(), n instanceof t.OctreeNode && !o.positionLast.equals(o.position) && (r = o.indexOctant, n.getOctantIndex(o) !== r && s.push(o)); for (e = 0, i = s.length; e < i; e++)o = s[e], o.node.removeObject(o), this.root.addObject(o) }, updateObject: function (t) { var e, i, n, o, r = [t]; for (n = t.parent; n;)r.push(n), n = n.parent; for (e = 0, i = r.length; e < i; e++)n = r[e], !0 === n.matrixWorldNeedsUpdate && (o = n); void 0 !== o && o.updateMatrixWorld() }, search: function (e, i, n, r) { var s, a, c, h, u, l, d, p, f, _, m; for (h = [].concat(this.root.objects), i > 0 || (i = Number.MAX_VALUE), r instanceof t.Vector3 && (r = this.utilVec31Search.copy(r).normalize(), m = this.utilVec32Search.set(1, 1, 1).divide(r)), s = 0, a = this.root.nodesIndices.length; s < a; s++)c = this.root.nodesByIndex[this.root.nodesIndices[s]], h = c.search(e, i, h, r, m); if (!0 === n) for (d = [], f = [], s = 0, a = h.length; s < a; s++)u = h[s], l = u.object, _ = o(f, l), -1 === _ ? (p = { object: l, faces: [], vertices: [] }, d.push(p), f.push(l)) : p = d[_], u.faces ? p.faces.push(u.faces) : u.vertices && p.vertices.push(u.vertices); else d = h; return d }, setRoot: function (e) { e instanceof t.OctreeNode && (this.root = e, this.root.updateProperties()) }, getDepthEnd: function () { return this.root.getDepthEnd() }, getNodeCountEnd: function () { return this.root.getNodeCountEnd() }, getObjectCountEnd: function () { return this.root.getObjectCountEnd() }, toConsole: function () { this.root.toConsole() } }, t.OctreeObjectData = function (e, i) { this.object = e, i instanceof t.Face3 ? (this.faces = i, this.face3 = !0, this.utilVec31FaceBounds = new t.Vector3()) : i instanceof t.Vector3 && (this.vertices = i), this.radius = 0, this.position = new t.Vector3(), this.object instanceof t.Object3D && this.update(), this.positionLast = this.position.clone() }, t.OctreeObjectData.prototype = { update: function () { this.face3 ? (this.radius = this.getFace3BoundingRadius(this.object, this.faces), this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)) : this.vertices ? (this.radius = this.object.material.size || 1, this.position.copy(this.vertices).applyMatrix4(this.object.matrixWorld)) : this.object.geometry ? (null === this.object.geometry.boundingSphere && this.object.geometry.computeBoundingSphere(), this.radius = this.object.geometry.boundingSphere.radius, this.position.copy(this.object.geometry.boundingSphere.center).applyMatrix4(this.object.matrixWorld)) : (this.radius = this.object.boundRadius, this.position.setFromMatrixPosition(this.object.matrixWorld)), this.radius = this.radius * Math.max(this.object.scale.x, this.object.scale.y, this.object.scale.z) }, getFace3BoundingRadius: function (e, i) { void 0 === i.centroid && (i.centroid = new t.Vector3()); var n = e.geometry || e, o = n.vertices, r = i.centroid, s = o[i.a], a = o[i.b], c = o[i.c], h = this.utilVec31FaceBounds; return r.addVectors(s, a).add(c).divideScalar(3), Math.max(h.subVectors(r, s).length(), h.subVectors(r, a).length(), h.subVectors(r, c).length()) } }, t.OctreeNode = function (e) { this.utilVec31Branch = new t.Vector3(), this.utilVec31Expand = new t.Vector3(), this.utilVec31Ray = new t.Vector3(), e = e || {}, e.tree instanceof t.Octree ? this.tree = e.tree : e.parent instanceof t.OctreeNode != !0 && (e.root = this, this.tree = new t.Octree(e)), this.id = this.tree.nodeCount++ , this.position = e.position instanceof t.Vector3 ? e.position : new t.Vector3(), this.radius = e.radius > 0 ? e.radius : 1, this.indexOctant = e.indexOctant, this.depth = 0, this.reset(), this.setParent(e.parent), this.overlap = this.radius * this.tree.overlapPct, this.radiusOverlap = this.radius + this.overlap, this.left = this.position.x - this.radiusOverlap, this.right = this.position.x + this.radiusOverlap, this.bottom = this.position.y - this.radiusOverlap, this.top = this.position.y + this.radiusOverlap, this.back = this.position.z - this.radiusOverlap, this.front = this.position.z + this.radiusOverlap, this.tree.scene && (this.visual = new t.Mesh(this.tree.visualGeometry, this.tree.visualMaterial), this.visual.scale.set(2 * this.radiusOverlap, 2 * this.radiusOverlap, 2 * this.radiusOverlap), this.visual.position.copy(this.position), this.tree.scene.add(this.visual)) }, t.OctreeNode.prototype = { setParent: function (t) { t !== this && this.parent !== t && (this.parent = t, this.updateProperties()) }, updateProperties: function () { var e, i; for (this.parent instanceof t.OctreeNode ? (this.tree = this.parent.tree, this.depth = this.parent.depth + 1) : this.depth = 0, e = 0, i = this.nodesIndices.length; e < i; e++)this.nodesByIndex[this.nodesIndices[e]].updateProperties() }, reset: function (t, e) { var i, n, o, r = this.nodesIndices || [], s = this.nodesByIndex; for (this.objects = [], this.nodesIndices = [], this.nodesByIndex = {}, i = 0, n = r.length; i < n; i++)o = s[r[i]], o.setParent(void 0), !0 === t && o.reset(t, e); !0 === e && this.visual && this.visual.parent && this.visual.parent.remove(this.visual) }, addNode: function (t, e) { t.indexOctant = e, -1 === o(this.nodesIndices, e) && this.nodesIndices.push(e), this.nodesByIndex[e] = t, t.parent !== this && t.setParent(this) }, removeNode: function (t) { var e, i; e = o(this.nodesIndices, t), this.nodesIndices.splice(e, 1), i = i || this.nodesByIndex[t], delete this.nodesByIndex[t], i.parent === this && i.setParent(void 0) }, addObject: function (e) { var i, n, r; n = this.getOctantIndex(e), n > -1 && this.nodesIndices.length > 0 ? (r = this.branch(n), r.addObject(e)) : n < -1 && this.parent instanceof t.OctreeNode ? this.parent.addObject(e) : (i = o(this.objects, e), -1 === i && this.objects.push(e), e.node = this, this.checkGrow()) }, addObjectWithoutCheck: function (t) { var e, i, n; for (e = 0, i = t.length; e < i; e++)n = t[e], this.objects.push(n), n.node = this }, removeObject: function (t) { var e, i, n, o; if (o = this.removeObjectRecursive(t, { searchComplete: !1, nodesRemovedFrom: [], objectsDataRemoved: [] }), n = o.nodesRemovedFrom, n.length > 0) for (e = 0, i = n.length; e < i; e++)n[e].shrink(); return o.objectsDataRemoved }, removeObjectRecursive: function (e, i) { var n, r, s, a, c, h = -1; if (e instanceof t.OctreeObjectData) -1 !== (h = o(this.objects, e)) && (this.objects.splice(h, 1), e.node = void 0, i.objectsDataRemoved.push(e), i.searchComplete = c = !0); else for (n = this.objects.length - 1; n >= 0; n--)if (s = this.objects[n], s.object === e && (this.objects.splice(n, 1), s.node = void 0, i.objectsDataRemoved.push(s), c = !0, !s.faces && !s.vertices)) { i.searchComplete = !0; break } if (!0 === c && i.nodesRemovedFrom.push(this), !0 !== i.searchComplete) for (n = 0, r = this.nodesIndices.length; n < r && (a = this.nodesByIndex[this.nodesIndices[n]], i = a.removeObjectRecursive(e, i), !0 !== i.searchComplete); n++); return i }, checkGrow: function () { this.objects.length > this.tree.objectsThreshold && this.tree.objectsThreshold > 0 && this.grow() }, grow: function () { var t, e, i, n, o = [], r = [], s = [], a = [], c = []; for (i = 0, n = this.objects.length; i < n; i++)e = this.objects[i], t = this.getOctantIndex(e), t > -1 ? (s.push(e), a.push(t)) : t < -1 ? (o.push(e), r.push(t)) : c.push(e); s.length > 0 && (c = c.concat(this.split(s, a))), o.length > 0 && (c = c.concat(this.expand(o, r))), this.objects = c, this.checkMerge() }, split: function (t, e) { var i, n, o, r, s, a; if (this.depth < this.tree.depthMax) { for (t = t || this.objects, e = e || [], a = [], i = 0, n = t.length; i < n; i++)r = t[i], o = e[i], o > -1 ? (s = this.branch(o), s.addObject(r)) : a.push(r); t === this.objects && (this.objects = a) } else a = this.objects; return a }, branch: function (e) { var i, n, o, r, s, a; return this.nodesByIndex[e] instanceof t.OctreeNode ? i = this.nodesByIndex[e] : (o = .5 * this.radiusOverlap, n = o * this.tree.overlapPct, r = o - n, s = this.utilVec31Branch.set(1 & e ? r : -r, 2 & e ? r : -r, 4 & e ? r : -r), a = (new t.Vector3()).addVectors(this.position, s), i = new t.OctreeNode({ tree: this.tree, parent: this, position: a, radius: o, indexOctant: e }), this.addNode(i, e)), i }, expand: function (e, i) { var n, o, r, s, a, c, h, u, l, d, p, f, _, m, v, g, b, O, y, j, x, E, w, I, M, D, T, S, P, C = this.tree.INDEX_OUTSIDE_MAP, F = this.utilVec31Expand; if (this.tree.root.getDepthEnd() < this.tree.depthMax) { for (e = e || this.objects, i = i || [], s = [], a = [], n = 0, o = C.length; n < o; n++)C[n].count = 0; for (n = 0, o = e.length; n < o; n++)r = e[n], c = i[n], c < -1 ? (h = -c - this.tree.INDEX_OUTSIDE_OFFSET, h & this.tree.FLAG_POS_X ? C[this.tree.INDEX_OUTSIDE_POS_X].count++ : h & this.tree.FLAG_NEG_X && C[this.tree.INDEX_OUTSIDE_NEG_X].count++ , h & this.tree.FLAG_POS_Y ? C[this.tree.INDEX_OUTSIDE_POS_Y].count++ : h & this.tree.FLAG_NEG_Y && C[this.tree.INDEX_OUTSIDE_NEG_Y].count++ , h & this.tree.FLAG_POS_Z ? C[this.tree.INDEX_OUTSIDE_POS_Z].count++ : h & this.tree.FLAG_NEG_Z && C[this.tree.INDEX_OUTSIDE_NEG_Z].count++ , a.push(r)) : s.push(r); if (a.length > 0) for (l = C.slice(0), l.sort(function (t, e) { return e.count - t.count }), d = l[0], _ = 1 | d.index, v = l[1], g = l[2], p = (1 | v.index) !== _ ? v : g, m = 1 | p.index, v = l[2], g = l[3], b = l[4], O = 1 | v.index, y = 1 | g.index, f = O !== _ && O !== m ? v : y !== _ && y !== m ? g : b, j = d.x + p.x + f.x, x = d.y + p.y + f.y, E = d.z + p.z + f.z, c = this.getOctantIndexFromPosition(j, x, E), u = this.getOctantIndexFromPosition(-j, -x, -E), w = this.overlap, I = this.radius, D = this.tree.overlapPct > 0 ? w / (.5 * this.tree.overlapPct * (1 + this.tree.overlapPct)) : 2 * I, T = D * this.tree.overlapPct, M = D + T - (I + w), F.set(1 & c ? M : -M, 2 & c ? M : -M, 4 & c ? M : -M), S = (new t.Vector3()).addVectors(this.position, F), P = new t.OctreeNode({ tree: this.tree, position: S, radius: D }), P.addNode(this, u), this.tree.setRoot(P), n = 0, o = a.length; n < o; n++)this.tree.root.addObject(a[n]); e === this.objects && (this.objects = s) } else s = e; return s }, shrink: function () { this.checkMerge(), this.tree.root.checkContract() }, checkMerge: function () { for (var e, i = this; i.parent instanceof t.OctreeNode && i.getObjectCountEnd() < this.tree.objectsThreshold;)e = i, i = i.parent; i !== this && i.merge(e) }, merge: function (t) { var e, i, o; for (t = n(t), e = 0, i = t.length; e < i; e++)o = t[e], this.addObjectWithoutCheck(o.getObjectsEnd()), o.reset(!0, !0), this.removeNode(o.indexOctant, o); this.checkMerge() }, checkContract: function () { var e, i, n, o, r, s, a; if (this.nodesIndices.length > 0) { for (s = 0, a = this.objects.length, e = 0, i = this.nodesIndices.length; e < i; e++)n = this.nodesByIndex[this.nodesIndices[e]], o = n.getObjectCountEnd(), a += o, (r instanceof t.OctreeNode == !1 || o > s) && (r = n, s = o); a -= s, a < this.tree.objectsThreshold && r instanceof t.OctreeNode && this.contract(r) } }, contract: function (t) { var e, i, n; for (e = 0, i = this.nodesIndices.length; e < i; e++)(n = this.nodesByIndex[this.nodesIndices[e]]) !== t && (t.addObjectWithoutCheck(n.getObjectsEnd()), n.reset(!0, !0)); t.addObjectWithoutCheck(this.objects), this.reset(!1, !0), this.tree.setRoot(t), t.checkContract() }, getOctantIndex: function (e) { var i, n, o, r, s, a, c, h, u = this.position, l = this.radiusOverlap, d = this.overlap, p = 0; if (e instanceof t.OctreeObjectData ? (n = e.radius, i = e.position, e.positionLast.copy(i)) : e instanceof t.OctreeNode && (i = e.position, n = 0), o = i.x - u.x, r = i.y - u.y, s = i.z - u.z, a = Math.abs(o), c = Math.abs(r), h = Math.abs(s), Math.max(a, c, h) + n > l) return a + n > l && (p ^= o > 0 ? this.tree.FLAG_POS_X : this.tree.FLAG_NEG_X), c + n > l && (p ^= r > 0 ? this.tree.FLAG_POS_Y : this.tree.FLAG_NEG_Y), h + n > l && (p ^= s > 0 ? this.tree.FLAG_POS_Z : this.tree.FLAG_NEG_Z), e.indexOctant = -p - this.tree.INDEX_OUTSIDE_OFFSET, e.indexOctant; if (o - n > -d) p |= 1; else if (!(o + n < d)) return e.indexOctant = this.tree.INDEX_INSIDE_CROSS, e.indexOctant; if (r - n > -d) p |= 2; else if (!(r + n < d)) return e.indexOctant = this.tree.INDEX_INSIDE_CROSS, e.indexOctant; if (s - n > -d) p |= 4; else if (!(s + n < d)) return e.indexOctant = this.tree.INDEX_INSIDE_CROSS, e.indexOctant; return e.indexOctant = p, e.indexOctant }, getOctantIndexFromPosition: function (t, e, i) { var n = 0; return t > 0 && (n |= 1), e > 0 && (n |= 2), i > 0 && (n |= 4), n }, search: function (t, e, i, n, o) { var r, s, a; if (!0 === (n ? this.intersectRay(t, n, e, o) : this.intersectSphere(t, e))) for (i = i.concat(this.objects), r = 0, s = this.nodesIndices.length; r < s; r++)a = this.nodesByIndex[this.nodesIndices[r]], i = a.search(t, e, i, n); return i }, intersectSphere: function (t, e) { var i = e * e, n = t.x, o = t.y, r = t.z; return n < this.left ? i -= Math.pow(n - this.left, 2) : n > this.right && (i -= Math.pow(n - this.right, 2)), o < this.bottom ? i -= Math.pow(o - this.bottom, 2) : o > this.top && (i -= Math.pow(o - this.top, 2)), r < this.back ? i -= Math.pow(r - this.back, 2) : r > this.front && (i -= Math.pow(r - this.front, 2)), i >= 0 }, intersectRay: function (t, e, i, n) { void 0 === n && (n = this.utilVec31Ray.set(1, 1, 1).divide(e)); var o, r = (this.left - t.x) * n.x, s = (this.right - t.x) * n.x, a = (this.bottom - t.y) * n.y, c = (this.top - t.y) * n.y, h = (this.back - t.z) * n.z, u = (this.front - t.z) * n.z, l = Math.min(Math.min(Math.max(r, s), Math.max(a, c)), Math.max(h, u)); return !(l < 0) && !((o = Math.max(Math.max(Math.min(r, s), Math.min(a, c)), Math.min(h, u))) > l || o > i) }, getDepthEnd: function (t) { var e, i, n; if (this.nodesIndices.length > 0) for (e = 0, i = this.nodesIndices.length; e < i; e++)n = this.nodesByIndex[this.nodesIndices[e]], t = n.getDepthEnd(t); else t = !t || this.depth > t ? this.depth : t; return t }, getNodeCountEnd: function () { return this.tree.root.getNodeCountRecursive() + 1 }, getNodeCountRecursive: function () { var t, e, i = this.nodesIndices.length; for (t = 0, e = this.nodesIndices.length; t < e; t++)i += this.nodesByIndex[this.nodesIndices[t]].getNodeCountRecursive(); return i }, getObjectsEnd: function (t) { var e, i, n; for (t = (t || []).concat(this.objects), e = 0, i = this.nodesIndices.length; e < i; e++)n = this.nodesByIndex[this.nodesIndices[e]], t = n.getObjectsEnd(t); return t }, getObjectCountEnd: function () { var t, e, i = this.objects.length; for (t = 0, e = this.nodesIndices.length; t < e; t++)i += this.nodesByIndex[this.nodesIndices[t]].getObjectCountEnd(); return i }, getObjectCountStart: function () { for (var e = this.objects.length, i = this.parent; i instanceof t.OctreeNode;)e += i.objects.length, i = i.parent; return e }, toConsole: function (t) { var e, i, n; for (t = "string" === typeof t ? t : "   ", console.log(this.parent ? t + " octree NODE > " : " octree ROOT > ", this, " // id: ", this.id, " // indexOctant: ", this.indexOctant, " // position: ", this.position.x, this.position.y, this.position.z, " // radius: ", this.radius, " // depth: ", this.depth), console.log(this.parent ? t + " " : " ", "+ objects ( ", this.objects.length, " ) ", this.objects), console.log(this.parent ? t + " " : " ", "+ children ( ", this.nodesIndices.length, " )", this.nodesIndices, this.nodesByIndex), e = 0, i = this.nodesIndices.length; e < i; e++)n = this.nodesByIndex[this.nodesIndices[e]], n.toConsole(t + "   ") } }, t.Raycaster.prototype.intersectOctreeObject = function (e, i) { var n, o, r, s; if (e.object instanceof t.Object3D) { o = e, e = o.object; var a = void 0 !== e.geometry; s = o.faces, a && (r = e.geometry.faces), s.length > 0 && a && (e.geometry.faces = s), n = this.intersectObject(e, i), s.length > 0 && a && (e.geometry.faces = r) } else n = this.intersectObject(e, i); return n }, t.Raycaster.prototype.intersectOctreeObjects = function (t, e) { var i, n, o = []; for (i = 0, n = t.length; i < n; i++)o = o.concat(this.intersectOctreeObject(t[i], e)); return o } }(n)
}, function (t, e, i) { function n() { this._objects = {} } var o = i(0); n.prototype = { constructor: n, _objects: null, _getObjectId: function (t) { return t.id + ":" + t.uuid }, update: function () { for (var t in this._objects) { var e = this._objects[t]; e && "function" === typeof e.render && e.render() } }, add: function (t) { var e = this._getObjectId(t); this.contains(e) || (this._objects[e] = t) }, remove: function (t) { var e = this._getObjectId(t); this.contains(e) && delete this._objects[e] }, contains: function (t) { return t instanceof o.Object3D && (t = this._getObjectId(t)), void 0 !== this._objects[t] } }, t.exports = n }, function (t, e, i) { var n = i(0); n.OrbitControls = function (t, e) { function i() { return 2 * Math.PI / 60 / 60 * L.autoRotateSpeed } function o() { return Math.pow(.95, L.zoomSpeed) } function r(t) { X.theta -= t } function s(t) { X.phi -= t } function a(t) { L.object instanceof n.PerspectiveCamera ? V /= t : L.object instanceof n.OrthographicCamera ? (L.object.zoom = Math.max(L.minZoom, Math.min(L.maxZoom, L.object.zoom * t)), L.object.updateProjectionMatrix(), B = !0) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."), L.enableZoom = !1) } function c(t) { L.object instanceof n.PerspectiveCamera ? V *= t : L.object instanceof n.OrthographicCamera ? (L.object.zoom = Math.max(L.minZoom, Math.min(L.maxZoom, L.object.zoom / t)), L.object.updateProjectionMatrix(), B = !0) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."), L.enableZoom = !1) } function h(t) { Y.set(t.clientX, t.clientY) } function u(t) { J.set(t.clientX, t.clientY) } function l(t) { q.set(t.clientX, t.clientY) } function d(t) { Z.set(t.clientX, t.clientY), W.subVectors(Z, Y); var e = L.domElement === document ? L.domElement.body : L.domElement; r(2 * Math.PI * W.x / e.clientWidth * L.rotateSpeed), s(2 * Math.PI * W.y / e.clientHeight * L.rotateSpeed), Y.copy(Z), L.update() } function p(t) { $.set(t.clientX, t.clientY), tt.subVectors($, J), tt.y > 0 ? a(o()) : tt.y < 0 && c(o()), J.copy($), L.update() } function f(t) { K.set(t.clientX, t.clientY), Q.subVectors(K, q), nt(Q.x, Q.y), q.copy(K), L.update() } function _(t) { } function m(t) { var e = 0; void 0 !== t.wheelDelta ? e = t.wheelDelta : void 0 !== t.detail && (e = -t.detail), e > 0 ? c(o()) : e < 0 && a(o()), L.update() } function v(t) { switch (t.keyCode) { case L.keys.UP: nt(0, L.keyPanSpeed), L.update(); break; case L.keys.BOTTOM: nt(0, -L.keyPanSpeed), L.update(); break; case L.keys.LEFT: nt(L.keyPanSpeed, 0), L.update(); break; case L.keys.RIGHT: nt(-L.keyPanSpeed, 0), L.update() } } function g(t) { Y.set(t.touches[0].pageX, t.touches[0].pageY) } function b(t) { var e = t.touches[0].pageX - t.touches[1].pageX, i = t.touches[0].pageY - t.touches[1].pageY, n = Math.sqrt(e * e + i * i); J.set(0, n) } function O(t) { q.set(t.touches[0].pageX, t.touches[0].pageY) } function y(t) { Z.set(t.touches[0].pageX, t.touches[0].pageY), W.subVectors(Z, Y); var e = L.domElement === document ? L.domElement.body : L.domElement; r(2 * Math.PI * W.x / e.clientWidth * L.rotateSpeed), s(2 * Math.PI * W.y / e.clientHeight * L.rotateSpeed), Y.copy(Z), L.update() } function j(t) { var e = t.touches[0].pageX - t.touches[1].pageX, i = t.touches[0].pageY - t.touches[1].pageY, n = Math.sqrt(e * e + i * i); $.set(0, n), tt.subVectors($, J), tt.y > 0 ? c(o()) : tt.y < 0 && a(o()), J.copy($), L.update() } function x(t) { K.set(t.touches[0].pageX, t.touches[0].pageY), Q.subVectors(K, q), nt(Q.x, Q.y), q.copy(K), L.update() } function E(t) { } function w(t) { if (!1 !== L.enabled) { if (t.preventDefault(), t.button === L.mouseButtons.ORBIT) { if (!1 === L.enableRotate) return; h(t), z = k.ROTATE } else if (t.button === L.mouseButtons.ZOOM) { if (!1 === L.enableZoom) return; u(t), z = k.DOLLY } else if (t.button === L.mouseButtons.PAN) { if (!1 === L.enablePan) return; l(t), z = k.PAN } z !== k.NONE && (document.addEventListener("mousemove", I, !1), document.addEventListener("mouseup", M, !1), document.addEventListener("mouseout", M, !1), L.dispatchEvent(A)) } } function I(t) { if (!1 !== L.enabled) if (t.preventDefault(), z === k.ROTATE) { if (!1 === L.enableRotate) return; d(t) } else if (z === k.DOLLY) { if (!1 === L.enableZoom) return; p(t) } else if (z === k.PAN) { if (!1 === L.enablePan) return; f(t) } } function M(t) { !1 !== L.enabled && (_(t), document.removeEventListener("mousemove", I, !1), document.removeEventListener("mouseup", M, !1), document.removeEventListener("mouseout", M, !1), L.dispatchEvent(U), z = k.NONE) } function D(t) { !1 === L.enabled || !1 === L.enableZoom || z !== k.NONE && z !== k.ROTATE || (t.preventDefault(), t.stopPropagation(), m(t), L.dispatchEvent(A), L.dispatchEvent(U)) } function T(t) { !1 !== L.enabled && !1 !== L.enableKeys && !1 !== L.enablePan && v(t) } function S(t) { if (!1 !== L.enabled) { switch (t.touches.length) { case 1: if (!1 === L.enableRotate) return; g(t), z = k.TOUCH_ROTATE; break; case 2: if (!1 === L.enableZoom) return; b(t), z = k.TOUCH_DOLLY; break; case 3: if (!1 === L.enablePan) return; O(t), z = k.TOUCH_PAN; break; default: z = k.NONE }z !== k.NONE && L.dispatchEvent(A) } } function P(t) { if (!1 !== L.enabled) switch (t.preventDefault(), t.stopPropagation(), t.touches.length) { case 1: if (!1 === L.enableRotate) return; if (z !== k.TOUCH_ROTATE) return; y(t); break; case 2: if (!1 === L.enableZoom) return; if (z !== k.TOUCH_DOLLY) return; j(t); break; case 3: if (!1 === L.enablePan) return; if (z !== k.TOUCH_PAN) return; x(t); break; default: z = k.NONE } } function C(t) { !1 !== L.enabled && (E(t), L.dispatchEvent(U), z = k.NONE) } function F(t) { t.preventDefault() } this.object = t, this.domElement = void 0 !== e ? e : document, this.enabled = !0, this.target = new n.Vector3(), this.minDistance = 0, this.maxDistance = 1 / 0, this.minZoom = 0, this.maxZoom = 1 / 0, this.minPolarAngle = 0, this.maxPolarAngle = Math.PI, this.minAzimuthAngle = -1 / 0, this.maxAzimuthAngle = 1 / 0, this.enableDamping = !1, this.dampingFactor = .25, this.enableZoom = !0, this.zoomSpeed = 1, this.enableRotate = !0, this.rotateSpeed = 1, this.enablePan = !0, this.keyPanSpeed = 7, this.autoRotate = !1, this.autoRotateSpeed = 2, this.enableKeys = !0, this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 }, this.mouseButtons = { ORBIT: n.MOUSE.LEFT, ZOOM: n.MOUSE.MIDDLE, PAN: n.MOUSE.RIGHT }, this.target0 = this.target.clone(), this.position0 = this.object.position.clone(), this.zoom0 = this.object.zoom, this.getPolarAngle = function () { return R.phi }, this.getAzimuthalAngle = function () { return R.theta }, this.reset = function () { L.target.copy(L.target0), L.object.position.copy(L.position0), L.object.zoom = L.zoom0, L.object.updateProjectionMatrix(), L.dispatchEvent(N), L.update(), z = k.NONE }, this.update = function () { var e = new n.Vector3(), o = (new n.Quaternion()).setFromUnitVectors(t.up, new n.Vector3(0, 1, 0)), s = o.clone().inverse(), a = new n.Vector3(), c = new n.Quaternion(); return function () { var t = L.object.position; return e.copy(t).sub(L.target), e.applyQuaternion(o), R.setFromVector3(e), L.autoRotate && z === k.NONE && r(i()), R.theta += X.theta, R.phi += X.phi, R.theta = Math.max(L.minAzimuthAngle, Math.min(L.maxAzimuthAngle, R.theta)), R.phi = Math.max(L.minPolarAngle, Math.min(L.maxPolarAngle, R.phi)), R.makeSafe(), R.radius *= V, R.radius = Math.max(L.minDistance, Math.min(L.maxDistance, R.radius)), L.target.add(H), e.setFromSpherical(R), e.applyQuaternion(s), t.copy(L.target).add(e), L.object.lookAt(L.target), !0 === L.enableDamping ? (X.theta *= 1 - L.dampingFactor, X.phi *= 1 - L.dampingFactor) : X.set(0, 0, 0), V = 1, H.set(0, 0, 0), !!(B || a.distanceToSquared(L.object.position) > G || 8 * (1 - c.dot(L.object.quaternion)) > G) && (L.dispatchEvent(N), a.copy(L.object.position), c.copy(L.object.quaternion), B = !1, !0) } }(), this.dispose = function () { L.domElement.removeEventListener("contextmenu", F, !1), L.domElement.removeEventListener("mousedown", w, !1), L.domElement.removeEventListener("mousewheel", D, !1), L.domElement.removeEventListener("MozMousePixelScroll", D, !1), L.domElement.removeEventListener("touchstart", S, !1), L.domElement.removeEventListener("touchend", C, !1), L.domElement.removeEventListener("touchmove", P, !1), document.removeEventListener("mousemove", I, !1), document.removeEventListener("mouseup", M, !1), document.removeEventListener("mouseout", M, !1), window.removeEventListener("keydown", T, !1) }; var L = this, N = { type: "change" }, A = { type: "start" }, U = { type: "end" }, k = { NONE: -1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 }, z = k.NONE, G = 1e-6, R = new n.Spherical(), X = new n.Spherical(), V = 1, H = new n.Vector3(), B = !1, Y = new n.Vector2(), Z = new n.Vector2(), W = new n.Vector2(), q = new n.Vector2(), K = new n.Vector2(), Q = new n.Vector2(), J = new n.Vector2(), $ = new n.Vector2(), tt = new n.Vector2(), et = function () { var t = new n.Vector3(); return function (e, i) { t.setFromMatrixColumn(i, 0), t.multiplyScalar(-e), H.add(t) } }(), it = function () { var t = new n.Vector3(); return function (e, i) { t.setFromMatrixColumn(i, 1), t.multiplyScalar(e), H.add(t) } }(), nt = function () { var t = new n.Vector3(); return function (e, i) { var o = L.domElement === document ? L.domElement.body : L.domElement; if (L.object instanceof n.PerspectiveCamera) { var r = L.object.position; t.copy(r).sub(L.target); var s = t.length(); s *= Math.tan(L.object.fov / 2 * Math.PI / 180), et(2 * e * s / o.clientHeight, L.object.matrix), it(2 * i * s / o.clientHeight, L.object.matrix) } else L.object instanceof n.OrthographicCamera ? (et(e * (L.object.right - L.object.left) / L.object.zoom / o.clientWidth, L.object.matrix), it(i * (L.object.top - L.object.bottom) / L.object.zoom / o.clientHeight, L.object.matrix)) : (console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."), L.enablePan = !1) } }(); L.domElement.addEventListener("contextmenu", F, !1), L.domElement.addEventListener("mousedown", w, !1), L.domElement.addEventListener("mousewheel", D, !1), L.domElement.addEventListener("MozMousePixelScroll", D, !1), L.domElement.addEventListener("touchstart", S, !1), L.domElement.addEventListener("touchend", C, !1), L.domElement.addEventListener("touchmove", P, !1), window.addEventListener("keydown", T, !1), this.update() }, n.OrbitControls.prototype = Object.create(n.EventDispatcher.prototype), n.OrbitControls.prototype.constructor = n.OrbitControls, Object.defineProperties(n.OrbitControls.prototype, { center: { get: function () { return console.warn("THREE.OrbitControls: .center has been renamed to .target"), this.target } }, noZoom: { get: function () { return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."), !this.enableZoom }, set: function (t) { console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."), this.enableZoom = !t } }, noRotate: { get: function () { return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."), !this.enableRotate }, set: function (t) { console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."), this.enableRotate = !t } }, noPan: { get: function () { return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."), !this.enablePan }, set: function (t) { console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."), this.enablePan = !t } }, noKeys: { get: function () { return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."), !this.enableKeys }, set: function (t) { console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."), this.enableKeys = !t } }, staticMoving: { get: function () { return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."), !this.enableDamping }, set: function (t) { console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."), this.enableDamping = !t } }, dynamicDampingFactor: { get: function () { return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."), this.dampingFactor }, set: function (t) { console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."), this.dampingFactor = t } } }) }, function (t, e, i) { var n = i(0), o = i(3), r = i(1), s = i(17), a = i(4), c = i(18); i(19); var h = function () { n.Mesh.call(this) }; h.prototype = r(n.Mesh.prototype, s.prototype, {}); var u = function () { n.Group.call(this); var t = this, e = new n.ShaderMaterial({ uniforms: n.UniformsUtils.merge([n.UniformsLib.common, n.UniformsLib.lights], { positionT: { type: "f", value: 0 }, heightT: { type: "f", value: 0 }, size: { type: "f", value: this._columnSize }, positive: { type: "b", value: this._positive }, darkColor: { type: "c", value: new n.Color(3355443) }, opacity: { type: "f", value: 1 }, diffuse: { type: "c", value: new n.Color(13421772) }, emissive: { type: "c", value: new n.Color(3355443) }, shininess: { value: 30 } }), vertexShader: i(20), fragmentShader: i(21), side: n.DoubleSide, lights: !0, vertexColors: n.VertexColors }); this._matrix = new h(), this._matrix.interactive = !0, this._matrix.useFaces = !0, this._matrix.material = e, this._matrix.rotation.x = -Math.PI / 2, this._matrix.mouseOver = function (e) { t._focusColumnObject && (t._focusColumnObject.mouseOut(), t._focusColumnObject = null); var i = t._columnObjects[e.index]; i.edge && (i.mouseOver(), t._focusColumnObject = i, t.dispatchEvent({ type: "itemMouseOver", data: { edge: i.edge, source: t._vertexMap[i.edge.source], target: t._vertexMap[i.edge.target] }, mouseEvent: e })) }, this._matrix.mouseOut = function (e) { t._focusColumnObject && (t._focusColumnObject.mouseOut(), t.dispatchEvent({ type: "itemMouseOut", mouseEvent: e }), t._focusColumnObject = null) }, this._matrix.click = function (e) { if (t._focusColumnObject) { var i = t._focusColumnObject; t.dispatchEvent({ type: "itemClick", data: { edge: i.edge, source: t._vertexMap[i.edge.source], target: t._vertexMap[i.edge.target] }, mouseEvent: e }) } }, this.addObject(this._matrix), this._labelGroup0 = new n.Group(), this.addObject(this._labelGroup0), this._labelGroup1 = new n.Group(), this.addObject(this._labelGroup1), this._raycastMatrix = this._raycastMatrix.bind(this), this._labels = [], this._labelGroup1 = [], this._tweenObject = { t: 0 } }; u.prototype = r(n.Group.prototype, s.prototype, a.prototype, { constructor: u, _matrix: void 0, _labels: void 0, _labelGroup0: void 0, _labelGroup1: void 0, _columnSize: 10, _columnGap: 5, _columnHeightMax: 60, _ignoreColor: new n.Color(3355443), _differentColor: new n.Color(16777215), _highlightColor: new n.Color(16711680), _positive: !0, _vertexMap: void 0, _vertexIndexMap: void 0, _columnObjects: void 0, _focusColumnObject: void 0, _scaleX: 1, get scaleX() { return this._scaleX }, set scaleX(t) { this._scaleX = t, this._invalidateGeometry() }, _scaleY: 1, get scaleY() { return this._scaleY }, set scaleY(t) { this._scaleY = t, this._invalidateGeometry() }, _edgeData: null, get edgeData() { return this._edgeData }, set edgeData(t) { this._edgeData = t, this._invalidateGeometry() }, _vertexData: null, get vertexData() { return this._vertexData }, set vertexData(t) { this._vertexData = t, this._invalidateGeometry() }, get measuredWidth() { var t = this._vertexData.length; return t * this._columnSize + (t - 1) * this._columnGap }, get measuredHeight() { var t = this._vertexData.length; return t * this._columnSize + (t - 1) * this._columnGap }, _palette: [9972656, 6763988, 3040501, 3520758, 3197121, 4311414, 9160775, 15528015, 16107590], get palette() { return this._palette }, set palette(t) { t && (this._palette = t, this._invalidateGeometry()) }, _invalidateGeometryFlag: !1, _invalidateGeometry: function () { this._invalidateGeometryFlag || (this._invalidateGeometryFlag = !0, this.invalidateProperties()) }, _computeMatrixBoundingBox: function () { }, _computeMatrixBoundingSphere: function () { }, _raycastMatrix: function () { var t = new n.Mesh(); return function (e, i) { if (this._columnObjects instanceof Array && this._columnObjects.length > 0) { t.matrixWorld = this._matrix.matrixWorld; for (var n = i.length, o = this._positive, r = 0, s = this._columnObjects.length; r < s; r++) { var a = this._columnObjects[r]; if (a.color !== this._ignoreColor && (!(o && a.height < 0) && (o || !(a.height > 0)) && (t.geometry = a.geometry, t.raycast.call(t, e, i), i.length != n))) { var c = i[i.length - 1]; c.index = r, c.object = this._matrix; break } } } } }(), _updateMatrix: function () { var t = this, e = this._vertexData.length, i = this._columnSize, o = this._columnGap, r = this._columnHeightMax, s = this._ignoreColor, a = this._differentColor, c = {}; this._vertexMap = {}, this._vertexIndexMap = {}; for (var h = 0; h < e; h++) { var u = this._vertexData[h], l = this._palette[u.group]; void 0 === l && (l = a), c[u.group] = new n.Color(l), this._vertexMap[u.id] = u, this._vertexIndexMap[u.id] = h } for (var d = e * e, p = e * i + (e - 1) * o, f = e * i + (e - 1) * o, _ = p / 2 - i / 2, m = f / 2 - i / 2, v = {}, h = 0, g = this._edgeData.length; h < g; h++) { var b = this._edgeData[h], O = b.source, y = this._vertexMap[O], j = this._vertexIndexMap[O], x = b.target, E = this._vertexMap[x], w = this._vertexIndexMap[x]; y && E || console.error("Graph data is incomplete.", this._vertexData, this._edgeData); var I = { height: r * b.value, color: y.group == E.group ? c[y.group] : a, edge: b }; v[j * e + w] = I, v[w * e + j] = I } var M = new n.InstancedBufferGeometry(), D = new n.BoxBufferGeometry(1, 1, 1); M.maxInstancedCount = d, M.addAttribute("normal", D.attributes.normal), M.addAttribute("position", D.attributes.position), M.addAttribute("uv", D.attributes.uv), M.setIndex(D.index); for (var T = [], S = D.attributes.position.count, P = D.attributes.position.array, h = 0, C = 0; h < S; h++ , C += 3) { var F = C + 2; P[F] < 0 ? (T.push(0), P[F] = 0) : (T.push(1), P[F] = 1) } M.addAttribute("originFlag", new n.Float32Attribute(T, 1)); var L = new n.InstancedBufferAttribute(new Float32Array(d), 1, 1), N = new n.InstancedBufferAttribute(new Float32Array(3 * d), 3, 1), A = new n.InstancedBufferAttribute(new Float32Array(3 * d), 3, 1); this._columnObjects = []; for (var U = 0; U < e; U++)for (var k = 0; k < e; k++) { var h = U * e + k, I = k != U ? v[h] : { height: 0, color: s }; I || (I = { height: 0, color: s }), L.setX(h, I.height), A.setXYZ(h, I.color.r, I.color.g, I.color.b); var z = k * (i + o) - _, G = U * (i + o) - m; N.setXYZ(h, z, G, 0); var R = new n.BufferGeometry(); R.setIndex(M.getIndex()), R.addAttribute("normal", M.attributes.normal), R.addAttribute("uv", M.attributes.uv); for (var X = new n.Float32Attribute(3 * S, 3), V = 0, H = 0; V < S; V++ , H += 3) { var B = P[H] * i + z, Y = P[H + 1] * i + G, Z = (P[H + 2] < 1 ? 0 : I.height) + 0; X.setXYZ(V, B, Y, Z) } R.addAttribute("position", X); var W = { index: h, height: I.height, color: I.color, edge: I.edge, geometry: R, mouseOut: function () { var t = this.color; M.attributes.color.setXYZ(this.index, t.r, t.g, t.b), M.attributes.color.needsUpdate = !0 }, mouseOver: function () { var e = t._highlightColor; M.attributes.color.setXYZ(this.index, e.r, e.g, e.b), M.attributes.color.needsUpdate = !0 } }; this._columnObjects[W.index] = W } M.addAttribute("height", L), M.addAttribute("positionOffset", N), M.addAttribute("color", A), this._matrix.geometry = M; var q = p / 2; M.boundingBox = new n.Box3(new n.Vector3(-q, -q, -q), new n.Vector3(q, q, q)), M.boundingSphere = new n.Sphere(new n.Vector3(), p / 2), M.computeBoundingBox = this._computeMatrixBoundingBox, M.computeBoundingSphere = this._computeMatrixBoundingSphere, this._matrix.raycast = this._raycastMatrix }, _updateLabels: function () { for (; this._labels.length > 0;)this.removeObject(this._labels.pop()); for (var t = this._vertexData.length, e = this._columnSize, i = this._columnGap, o = t * e + (t - 1) * i, r = o / 2 - e / 2, s = {}, a = 0; a < t; a++) { var h = this._vertexData[a], u = this._palette[h.group]; void 0 === u && (u = this._differentColor); var l = new n.Color(u); s[h.group] = "#" + l.getHexString() } this._labelGroup1 = []; for (var a = 0, d = this._vertexData.length; a < d; a++) { var h = this._vertexData[a], p = h.name || "", f = c.createTextureWithText(p, { fillStyle: s[h.group], strokeStyle: "#FFFFFF", adaptable: !0, direction: 1, fontSize: 64, maxSize: 512 }), _ = f.image._width / f.image._height, m = e + i, v = m / _, g = new n.PlaneBufferGeometry(m, v), b = new n.MeshBasicMaterial({ map: f, side: n.DoubleSide, transparent: !0 }), O = new n.Mesh(g, b); O.rotation.x = -Math.PI / 2, O.position.x = a * (e + i) - r, O.position.z = o / 2 + v / 2 + i, O.scale.set(.01, .01, .01), this.addObject(O), this._labels.push(O), O = new n.Mesh(g, b), O.zPos = (d - a - 1) * (e + i) - r, O.zNeg = a * (e + i) - r, O.rotation.x = -Math.PI / 2, O.rotation.z = Math.PI / 2, O.position.x = o / 2 + v / 2 + i, O.position.z = O.zPos, O.scale.set(.01, .01, .01), this.addObject(O), this._labels.push(O), this._labelGroup1.push(O) } }, commitProperties: function () { this._invalidateGeometryFlag && (this._updateMatrix(), this._updateLabels(), this._invalidateGeometryFlag = !1) }, _tweenPosition: void 0, _tweenHeight: void 0, _tweenLabel: void 0, _tweenFlipMatrix: void 0, _tweenFlipLabel: void 0, _tweenObject: void 0, appear: function (t, e, i) { this._tweenPosition && (this._tweenPosition.stop(), this._tweenPosition = null), this._tweenHeight && (this._tweenHeight.stop(), this._tweenHeight = null), this._tweenLabel && (this._tweenLabel.stop(), this._tweenLabel = null); var n = this; this._matrix.material.uniforms.positionT.value = 0, this._matrix.material.uniforms.heightT.value = 0, this._labels.forEach(function (t) { t.scale.set(.01, .01, .01) }), t = t || 0, e = e || 1e3, this._tweenPosition = new o.Tween({ t: 0 }).to({ t: 1 }, e).easing(o.Easing.Cubic.InOut).delay(t).onUpdate(function () { n._matrix.material.uniforms.positionT.value = this.t }).onComplete(function () { }).start(), this._tweenHeight = new o.Tween({ t: 0 }).to({ t: 1 }, e).easing(o.Easing.Cubic.InOut).delay(t + e).onUpdate(function () { n._matrix.material.uniforms.heightT.value = this.t }).onComplete(function () { }).start(), this._tweenLabel = new o.Tween({ t: 0 }).to({ t: 1 }, e / 2).easing(o.Easing.Cubic.InOut).delay(t + 2 * e).onUpdate(function () { var t = this.t; n._labels.forEach(function (e) { var i = t; e.scale.set(i, i, i) }) }).onComplete(function () { "function" === typeof i && setTimeout(function () { i() }, 150) }).start() }, disappear: function (t, e, i) { this._tweenPosition && (this._tweenPosition.stop(), this._tweenPosition = null), this._tweenHeight && (this._tweenHeight.stop(), this._tweenHeight = null), this._tweenLabel && (this._tweenLabel.stop(), this._tweenLabel = null); var n = this; this._tweenPosition = new o.Tween({ t: 1 }).to({ t: 0 }, e || 1e3).easing(o.Easing.Cubic.InOut).delay(t || 0).onUpdate(function () { var t = this.t; n._matrix.material.uniforms.positionT.value = t, n._matrix.material.uniforms.heightT.value = t, n._labels.forEach(function (e) { var i = Math.max(t, .01); e.scale.set(i, i, i) }) }).onComplete(function () { "function" === typeof i && setTimeout(function () { i() }, 150) }).start() }, flip: function (t) { this._tweenFlipMatrix && (this._tweenFlipMatrix.stop(), this._tweenFlipMatrix = null), this._tweenFlipLabel && (this._tweenFlipLabel.stop(), this._tweenFlipLabel = null); var e = this; 0 == arguments.length && (t = this._matrix.rotation.x > 0); var i = t ? -Math.PI / 2 : Math.PI / 2; this._matrix.material.uniforms.positive.value = t, this._positive = t, this._tweenFlipMatrix = new o.Tween(this._matrix.rotation).to({ x: i }, 1e3).easing(o.Easing.Cubic.InOut).delay(0).onUpdate(function () { }).onComplete(function () { }).start(), this._tweenFlipLabel = new o.Tween(this._tweenObject).to({ t: t ? 0 : 1 }, 1e3).easing(o.Easing.Cubic.InOut).delay(0).onUpdate(function () { var t = this.t; e._labelGroup1.forEach(function (e, i) { var n = e.zPos + (e.zNeg - e.zPos) * t; e.position.z = n }) }).onComplete(function () { }).start() } }), t.exports = u }, function (t, e) { function i() { } i.prototype = { constructor: i, _stage3d: null, get stage3d() { return this._stage3d }, _interactive: !1, get interactive() { return this._interactive }, set interactive(t) { this._interactive = t, this._stage3d && (this._interactive ? this._stage3d.interactiveManager.add(this, this.useFaces) : this._stage3d.interactiveManager.remove(this)) }, _useFaces: !1, get useFaces() { return this._useFaces }, set useFaces(t) { this._useFaces = t }, _renderable: !1, get renderable() { return this._renderable }, set renderable(t) { this._renderable = t, this._stage3d && (this._renderable ? this._stage3d.renderableManager.add(this) : this._stage3d.renderableManager.remove(this)) }, addObject: function (t) { t && (t._stage3d = this._stage3d, "function" === typeof t._addedToStage && t._addedToStage(), this.add(t)) }, removeObject: function (t) { t && (this.remove(t), "function" === typeof t._removedFromStage && t._removedFromStage(), t._stage3d = null) }, _addedToStage: function () { var t = this; this._stage3d && (this.interactive && this._stage3d.interactiveManager.add(this, this.useFaces), this.renderable && this._stage3d.renderableManager.add(this), this.children instanceof Array && this.children.forEach(function (e) { e._stage3d = t._stage3d, "function" === typeof e._addedToStage && e._addedToStage() })) }, _removedFromStage: function () { this._stage3d && (this._stage3d.interactiveManager.remove(this), this._stage3d.renderableManager.remove(this), this.children instanceof Array && this.children.forEach(function (t) { "function" === typeof t._removedFromStage && t._removedFromStage(), t._stage3d = null })) } }, t.exports = i }, function (t, e, i) { function n(t) { o || (o = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")); var e = o.getContext("2d"); t && e.save(), e.setTransform(1, 0, 0, 1, 0, 0), e.clearRect(0, 0, o.width, o.height), t && e.restore(), o.width = 256, o.height = 256 } var o, r = i(0), s = { get canvas() { return n(), o }, createTextureWithText: function (t, e) { if (e = e || {}, n(), !0 === e.adaptable) { var i = e.direction || 0; m = e.fontSize || 256; var s = m; this.isPowerOfTwo(s) || (s = this.getBestPowerOf2(s)); var a = e.maxSize || m * t.length; this.isPowerOfTwo(a) || (a = this.getBestPowerOf2(a)), o.width = i ? s : a, o.height = i ? a : s, _ = o.getContext("2d"), _.font = "normal normal bolder " + m + "px ", _.textBaseline = "middle", _.fillStyle = e.fillStyle || "#FFFFFF", _.strokeStyle = e.strokeStyle || "#000000"; for (var c = i ? Math.round((o.width - m) / 2) : 0, h = i ? 0 : Math.round((o.height - m) / 2), u = m / 2, l = 0, d = t.length; l < d; l++) { var p = m * l, f = t.charAt(l); v = (i ? 0 : p) + c, g = (i ? p : 0) + h + u, _.fillText(f, v, g), _.strokeText(f, v, g) } } else { var _ = o.getContext("2d"), m = Math.floor(Math.min(o.width, o.height) / t.length); _.font = "normal normal bolder " + m + "px ", _.textBaseline = "middle"; var v = (o.width - t.length * m) / 2, g = o.height / 2; _.fillStyle = e.fillStyle || "#FFFFFF", _.fillText(t, v, g), _.strokeStyle = e.strokeStyle || "#000000", _.strokeText(t, v, g) } var b = new Image(); b.src = o.toDataURL(), b._width = o.width, b._height = o.height; var O = new r.Texture(b); return O.needsUpdate = !0, O }, createTextureWithSolidColor: function (t) { n(); var e = o.getContext("2d"); e.fillStyle = t || "#FFFFFF", e.fillRect(0, 0, o.width, o.height); var i = new Image(); i.src = o.toDataURL(); var s = new r.Texture(i); return s.needsUpdate = !0, s }, createTextureWithSvg: function (t) { n(), o.getContext("2d").fillRect(0, 0, o.width, o.height); var e = new Image(); e.src = o.toDataURL(); var i = new r.Texture(e); return i.needsUpdate = !0, i }, calculateVisiblePoints: function (t) { }, isPowerOfTwo: function (t) { return !!t && (t & -t) == t }, getBestPowerOf2: function (t) { for (var e = 1; e < t;)e <<= 1; return e > 4096 && (e = 4096), e }, mergeTexture: function (t, e) { n(), [].forEach(function (t, e) { }) } }; Object.seal(s), t.exports = s }, function (t, e, i) { var n = i(0); n.Geometry.prototype.merge2 = function (t, e, i) { if (!1 === (t && t.isGeometry)) return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.", t); var o, r = this.vertices.length, s = this.vertices, a = t.vertices, c = this.faces, h = t.faces, u = this.faceVertexUvs[0], l = t.faceVertexUvs[0]; void 0 === i && (i = 0), void 0 !== e && (o = (new n.Matrix3()).getNormalMatrix(e)); for (var d = 0, p = a.length; d < p; d++) { var f = a[d], _ = f.clone(); void 0 !== e && _.applyMatrix4(e), s.push(_) } for (d = 0, p = h.length; d < p; d++) { var m, v, g, b = h[d], O = b.vertexNormals, y = b.vertexColors; m = new n.Face3(b.a + r, b.b + r, b.c + r), m.normal.copy(b.normal), void 0 !== o && m.normal.applyMatrix3(o).normalize(); for (var j = 0, x = O.length; j < x; j++)v = O[j].clone(), void 0 !== o && v.applyMatrix3(o).normalize(), m.vertexNormals.push(v); m.color.copy(b.color); for (var j = 0, x = y.length; j < x; j++)g = y[j], m.vertexColors.push(g.clone()); m.materialIndex = i, c.push(m) } for (d = 0, p = l.length; d < p; d++) { var E = l[d], w = []; if (void 0 !== E) { for (var j = 0, x = E.length; j < x; j++)w.push(E[j].clone()); u.push(w) } } }, n.UniformsUtils.merge = function (t, e) { for (var i = {}, n = 0; n < t.length; n++) { var o = this.clone(t[n]); for (var r in o) i[r] = o[r] } if ("object" === typeof e && null != e) for (r in e) e.hasOwnProperty(r) && (i[r] = e[r]); return i } }, function (t, e) { t.exports = "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n//\x3c!--\nuniform float positionT;\nuniform float heightT;\nuniform float size;\nuniform bool positive;\nuniform vec3 darkColor;\n\nattribute float originFlag;\n\nattribute float height;\nattribute vec3 positionOffset;\n//--\x3e\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n#endif\n    #include <begin_vertex>\n    //\x3c!--\n    transformed = vec3(transformed.xy * size, originFlag * height * heightT) + positionOffset * positionT;\n//#ifdef USE_COLOR\n    vColor = positive && height > 0.0 ? vColor : !positive && height < 0.0 ? vColor : darkColor;\n//    float c = (1.0 + sin(alphaOffset + t)) / 2.0;\n//    vAlpha = 0.6 + 0.4 * c;\n//#endif\n    //--\x3e\n    #include <displacementmap_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <envmap_vertex>\n    #include <shadowmap_vertex>\n}" }, function (t, e) { t.exports = "#define PHONG\n//\x3c!--\n//--\x3e\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    //\x3c!--\n    //--\x3e\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <specularmap_fragment>\n    #include <normal_flip>\n    #include <normal_fragment>\n    #include <emissivemap_fragment>\n    #include <lights_phong_fragment>\n    #include <lights_template>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #include <envmap_fragment>\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    #include <premultiplied_alpha_fragment>\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n}" }, function (t, e, i) { var n = i(23); n.webgl ? console.log(["Jusfoun 3D Map Creator v0.1", "Jusfoun Visualization Department " + (new Date()).getFullYear(), "http://www.jusfoun.com"].join("\n")) : console.error("This platform does NOT support WebGL."), e.webgl = n.webgl }, function (t, e, i) { var n = { canvas: !!window.CanvasRenderingContext2D, webgl: function () { try { var t = document.createElement("canvas"); return !(!window.WebGLRenderingContext || !t.getContext("webgl") && !t.getContext("experimental-webgl")) } catch (t) { return !1 } }(), workers: !!window.Worker, fileapi: window.File && window.FileReader && window.FileList && window.Blob, getWebGLErrorMessage: function () { var t = document.createElement("div"); return t.id = "webgl-error-message", t.style.fontFamily = "monospace", t.style.fontSize = "13px", t.style.fontWeight = "normal", t.style.textAlign = "center", t.style.background = "#fff", t.style.color = "#000", t.style.padding = "1.5em", t.style.width = "400px", t.style.margin = "5em auto 0", this.webgl || (t.innerHTML = window.WebGLRenderingContext ? ['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />', 'Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n") : ['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>', 'Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")), t }, addGetWebGLMessage: function (t) { var e, i, o; t = t || {}, e = void 0 !== t.parent ? t.parent : document.body, i = void 0 !== t.id ? t.id : "oldie", o = n.getWebGLErrorMessage(), o.id = i, e.appendChild(o) } }; t.exports = n }]);
